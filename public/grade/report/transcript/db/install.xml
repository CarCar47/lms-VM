<?xml version="1.0" encoding="UTF-8" ?>
<XMLDB PATH="grade/report/transcript/db" VERSION="20251018" COMMENT="XMLDB file for Moodle gradereport_transcript"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="../../../../lib/xmldb/xmldb.xsd"
>
  <TABLES>
    <!-- Schools table -->
    <TABLE NAME="gradereport_transcript_schools" COMMENT="Stores school/institution information">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="name" TYPE="char" LENGTH="255" NOTNULL="true" SEQUENCE="false" COMMENT="School name"/>
        <FIELD NAME="address" TYPE="text" NOTNULL="false" SEQUENCE="false" COMMENT="School address"/>
        <FIELD NAME="phone" TYPE="char" LENGTH="50" NOTNULL="false" SEQUENCE="false" COMMENT="School phone number"/>
        <FIELD NAME="website" TYPE="char" LENGTH="255" NOTNULL="false" SEQUENCE="false" COMMENT="School website URL"/>
        <FIELD NAME="logo" TYPE="char" LENGTH="255" NOTNULL="false" SEQUENCE="false" COMMENT="Path to school logo file"/>
        <FIELD NAME="timecreated" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="timemodified" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
      </KEYS>
    </TABLE>

    <!-- Programs table -->
    <TABLE NAME="gradereport_transcript_programs" COMMENT="Stores program/course catalog information">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="schoolid" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Reference to school"/>
        <FIELD NAME="categoryid" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Moodle category ID"/>
        <FIELD NAME="name" TYPE="char" LENGTH="255" NOTNULL="true" SEQUENCE="false" COMMENT="Program name"/>
        <FIELD NAME="type" TYPE="char" LENGTH="20" NOTNULL="true" DEFAULT="hourbased" SEQUENCE="false" COMMENT="Type: hourbased, creditbased, or ceu"/>
        <FIELD NAME="pdftemplate" TYPE="char" LENGTH="255" NOTNULL="false" SEQUENCE="false" COMMENT="Path to PDF template file"/>
        <FIELD NAME="gradescaleid" TYPE="int" LENGTH="10" NOTNULL="false" DEFAULT="0" SEQUENCE="false" COMMENT="Custom grade scale ID"/>
        <FIELD NAME="hour1label" TYPE="char" LENGTH="50" NOTNULL="false" DEFAULT="Theory Hours" SEQUENCE="false" COMMENT="Label for first hour type"/>
        <FIELD NAME="hour2label" TYPE="char" LENGTH="50" NOTNULL="false" DEFAULT="Lab Hours" SEQUENCE="false" COMMENT="Label for second hour type"/>
        <FIELD NAME="hour3label" TYPE="char" LENGTH="50" NOTNULL="false" DEFAULT="Clinical Hours" SEQUENCE="false" COMMENT="Label for third hour type"/>
        <FIELD NAME="timecreated" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="timemodified" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="schoolid" TYPE="foreign" FIELDS="schoolid" REFTABLE="gradereport_transcript_schools" REFFIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="categoryid" UNIQUE="false" FIELDS="categoryid"/>
      </INDEXES>
    </TABLE>

    <!-- Course mappings table -->
    <TABLE NAME="gradereport_transcript_courses" COMMENT="Maps Moodle courses to PDF form fields">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="programid" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Reference to program"/>
        <FIELD NAME="courseid" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Moodle course ID"/>
        <FIELD NAME="sortorder" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Display order on transcript"/>
        <FIELD NAME="pdffieldprefix" TYPE="char" LENGTH="100" NOTNULL="false" SEQUENCE="false" COMMENT="PDF form field prefix (e.g., PMU1, PMU2)"/>
        <FIELD NAME="theoryhours" TYPE="number" LENGTH="10" DECIMALS="2" NOTNULL="false" SEQUENCE="false" DEFAULT="0" COMMENT="Theory hours for hour-based programs"/>
        <FIELD NAME="labhours" TYPE="number" LENGTH="10" DECIMALS="2" NOTNULL="false" SEQUENCE="false" DEFAULT="0" COMMENT="Lab hours for hour-based programs"/>
        <FIELD NAME="clinicalhours" TYPE="number" LENGTH="10" DECIMALS="2" NOTNULL="false" SEQUENCE="false" DEFAULT="0" COMMENT="Clinical hours for hour-based programs"/>
        <FIELD NAME="credits" TYPE="number" LENGTH="10" DECIMALS="2" NOTNULL="false" SEQUENCE="false" DEFAULT="0" COMMENT="Credits for credit-based programs"/>
        <FIELD NAME="ceuvalue" TYPE="number" LENGTH="10" DECIMALS="2" NOTNULL="false" SEQUENCE="false" DEFAULT="0" COMMENT="CEU value"/>
        <FIELD NAME="timecreated" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="timemodified" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="programid" TYPE="foreign" FIELDS="programid" REFTABLE="gradereport_transcript_programs" REFFIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="courseid" UNIQUE="false" FIELDS="courseid"/>
        <INDEX NAME="programcourse" UNIQUE="true" FIELDS="programid, courseid"/>
      </INDEXES>
    </TABLE>

    <!-- Pricing configuration table -->
    <TABLE NAME="gradereport_transcript_pricing" COMMENT="Stores pricing configuration per school">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="schoolid" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Reference to school"/>
        <FIELD NAME="firstfree" TYPE="int" LENGTH="1" NOTNULL="true" DEFAULT="1" SEQUENCE="false" COMMENT="First official transcript free (1=yes, 0=no)"/>
        <FIELD NAME="officialprice" TYPE="number" LENGTH="10" DECIMALS="2" NOTNULL="false" SEQUENCE="false" DEFAULT="0.00" COMMENT="Price for official transcripts"/>
        <FIELD NAME="unofficialprice" TYPE="number" LENGTH="10" DECIMALS="2" NOTNULL="false" SEQUENCE="false" DEFAULT="0.00" COMMENT="Price for unofficial transcripts"/>
        <FIELD NAME="timecreated" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="timemodified" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="schoolid" TYPE="foreign" FIELDS="schoolid" REFTABLE="gradereport_transcript_schools" REFFIELDS="id"/>
      </KEYS>
    </TABLE>

    <!-- Transcript requests table -->
    <TABLE NAME="gradereport_transcript_requests" COMMENT="Stores student transcript requests">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="userid" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Student user ID"/>
        <FIELD NAME="programid" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Reference to program"/>
        <FIELD NAME="requesttype" TYPE="char" LENGTH="20" NOTNULL="true" DEFAULT="unofficial" SEQUENCE="false" COMMENT="Type: official or unofficial"/>
        <FIELD NAME="status" TYPE="char" LENGTH="20" NOTNULL="true" DEFAULT="pending" SEQUENCE="false" COMMENT="Status: pending, approved, rejected"/>
        <FIELD NAME="deliverymethod" TYPE="char" LENGTH="20" NOTNULL="false" SEQUENCE="false" COMMENT="Method: email, mail, pickup"/>
        <FIELD NAME="recipientemail" TYPE="char" LENGTH="255" NOTNULL="false" SEQUENCE="false" COMMENT="Email address for delivery"/>
        <FIELD NAME="recipientaddress" TYPE="text" NOTNULL="false" SEQUENCE="false" COMMENT="Mailing address for physical delivery"/>
        <FIELD NAME="recipientname" TYPE="char" LENGTH="255" NOTNULL="false" SEQUENCE="false" COMMENT="Institution/company name for official transcripts"/>
        <FIELD NAME="recipientphone" TYPE="char" LENGTH="50" NOTNULL="false" SEQUENCE="false" COMMENT="Recipient phone number"/>
        <FIELD NAME="notes" TYPE="text" NOTNULL="false" SEQUENCE="false" COMMENT="Additional notes from student"/>
        <FIELD NAME="price" TYPE="number" LENGTH="10" DECIMALS="2" NOTNULL="false" SEQUENCE="false" DEFAULT="0.00" COMMENT="Calculated price for this request"/>
        <FIELD NAME="paymentstatus" TYPE="char" LENGTH="20" NOTNULL="true" DEFAULT="pending" SEQUENCE="false" COMMENT="Payment status: pending, paid, free"/>
        <FIELD NAME="paymentmethod" TYPE="char" LENGTH="20" NOTNULL="false" SEQUENCE="false" COMMENT="Payment method: cash, invoice"/>
        <FIELD NAME="invoicenumber" TYPE="char" LENGTH="50" NOTNULL="false" SEQUENCE="false" COMMENT="Invoice number for tracking"/>
        <FIELD NAME="invoicedate" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false" COMMENT="Date invoice was generated"/>
        <FIELD NAME="paiddate" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false" COMMENT="Date payment was received"/>
        <FIELD NAME="deliverystatus" TYPE="char" LENGTH="20" NOTNULL="true" DEFAULT="pending" SEQUENCE="false" COMMENT="Delivery status: pending/sent/delivered/pickedup"/>
        <FIELD NAME="deliverydate" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false" COMMENT="Date transcript was delivered"/>
        <FIELD NAME="deliverynotes" TYPE="text" NOTNULL="false" SEQUENCE="false" COMMENT="Delivery tracking notes"/>
        <FIELD NAME="trackingnumber" TYPE="char" LENGTH="100" NOTNULL="false" SEQUENCE="false" COMMENT="Postal tracking number"/>
        <FIELD NAME="receiptnumber" TYPE="char" LENGTH="100" NOTNULL="false" SEQUENCE="false" COMMENT="Payment receipt number"/>
        <FIELD NAME="paymentnotes" TYPE="text" NOTNULL="false" SEQUENCE="false" COMMENT="Additional payment information"/>
        <FIELD NAME="approvedby" TYPE="int" LENGTH="10" NOTNULL="false" DEFAULT="0" SEQUENCE="false" COMMENT="User ID who approved/rejected"/>
        <FIELD NAME="approvaldate" TYPE="int" LENGTH="10" NOTNULL="false" DEFAULT="0" SEQUENCE="false" COMMENT="Date of approval/rejection"/>
        <FIELD NAME="programstartdate" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false" COMMENT="Date student started the program (for official transcripts)"/>
        <FIELD NAME="completionstatus" TYPE="char" LENGTH="20" NOTNULL="false" SEQUENCE="false" COMMENT="Student completion status: graduated or withdrawn (for official transcripts)"/>
        <FIELD NAME="graduationdate" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false" COMMENT="Date student graduated from program (if status=graduated)"/>
        <FIELD NAME="withdrawndate" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false" COMMENT="Date student withdrew from program (if status=withdrawn)"/>
        <FIELD NAME="timecreated" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="timemodified" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="programid" TYPE="foreign" FIELDS="programid" REFTABLE="gradereport_transcript_programs" REFFIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="userid" UNIQUE="false" FIELDS="userid"/>
        <INDEX NAME="status" UNIQUE="false" FIELDS="status"/>
      </INDEXES>
    </TABLE>

    <!-- Verification codes table -->
    <TABLE NAME="gradereport_transcript_verify" COMMENT="Stores verification codes for issued transcripts">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="userid" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Student user ID"/>
        <FIELD NAME="programid" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Reference to program"/>
        <FIELD NAME="verificationcode" TYPE="char" LENGTH="64" NOTNULL="true" SEQUENCE="false" COMMENT="Unique verification code"/>
        <FIELD NAME="documenttype" TYPE="char" LENGTH="20" NOTNULL="true" SEQUENCE="false" COMMENT="Type: transcript or ceu"/>
        <FIELD NAME="issuedate" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Date transcript was issued"/>
        <FIELD NAME="expirydate" TYPE="int" LENGTH="10" NOTNULL="false" DEFAULT="0" SEQUENCE="false" COMMENT="Optional expiry date"/>
        <FIELD NAME="pdfhash" TYPE="char" LENGTH="64" NOTNULL="false" SEQUENCE="false" COMMENT="SHA256 hash of PDF file for integrity check"/>
        <FIELD NAME="timecreated" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="programid" TYPE="foreign" FIELDS="programid" REFTABLE="gradereport_transcript_programs" REFFIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="userid" UNIQUE="false" FIELDS="userid"/>
        <INDEX NAME="verificationcode" UNIQUE="true" FIELDS="verificationcode"/>
      </INDEXES>
    </TABLE>

    <!-- Transfer credits table -->
    <TABLE NAME="gradereport_transcript_transfer" COMMENT="Stores custom transfer credit entries per student">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="programid" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Reference to program"/>
        <FIELD NAME="userid" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Student user ID"/>
        <FIELD NAME="coursecode" TYPE="char" LENGTH="50" NOTNULL="true" SEQUENCE="false" COMMENT="Transfer course code"/>
        <FIELD NAME="coursename" TYPE="char" LENGTH="255" NOTNULL="true" SEQUENCE="false" COMMENT="Transfer course name"/>
        <FIELD NAME="grade" TYPE="char" LENGTH="10" NOTNULL="false" SEQUENCE="false" COMMENT="Letter grade earned"/>
        <FIELD NAME="credits" TYPE="number" LENGTH="10" DECIMALS="2" NOTNULL="false" SEQUENCE="false" DEFAULT="0" COMMENT="Credits for credit-based programs"/>
        <FIELD NAME="hours" TYPE="number" LENGTH="10" DECIMALS="2" NOTNULL="false" SEQUENCE="false" DEFAULT="0" COMMENT="Hours for hour-based programs"/>
        <FIELD NAME="transfersymbol" TYPE="char" LENGTH="10" NOTNULL="false" DEFAULT="T" SEQUENCE="false" COMMENT="Transfer symbol/notation"/>
        <FIELD NAME="institution" TYPE="char" LENGTH="255" NOTNULL="false" SEQUENCE="false" COMMENT="Originating institution name"/>
        <FIELD NAME="sortorder" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Display order on transcript"/>
        <FIELD NAME="timecreated" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="timemodified" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="programid" TYPE="foreign" FIELDS="programid" REFTABLE="gradereport_transcript_programs" REFFIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="userid" UNIQUE="false" FIELDS="userid"/>
        <INDEX NAME="userid_program" UNIQUE="false" FIELDS="userid, programid"/>
      </INDEXES>
    </TABLE>

    <!-- Custom grading scales table -->
    <TABLE NAME="gradereport_transcript_gradescale" COMMENT="Stores custom grading scale definitions per school">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="schoolid" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Reference to school"/>
        <FIELD NAME="lettergrade" TYPE="char" LENGTH="5" NOTNULL="true" SEQUENCE="false" COMMENT="Letter grade (A, B, C, etc.)"/>
        <FIELD NAME="minpercentage" TYPE="number" LENGTH="5" DECIMALS="2" NOTNULL="false" SEQUENCE="false" DEFAULT="0" COMMENT="Minimum percentage for this grade"/>
        <FIELD NAME="maxpercentage" TYPE="number" LENGTH="5" DECIMALS="2" NOTNULL="false" SEQUENCE="false" DEFAULT="0" COMMENT="Maximum percentage for this grade"/>
        <FIELD NAME="gradepoints" TYPE="number" LENGTH="3" DECIMALS="2" NOTNULL="false" SEQUENCE="false" DEFAULT="0" COMMENT="GPA points (e.g., 4.0, 3.0)"/>
        <FIELD NAME="quality" TYPE="char" LENGTH="50" NOTNULL="false" SEQUENCE="false" COMMENT="Quality descriptor (e.g., Excellent, Good)"/>
        <FIELD NAME="sortorder" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Display order"/>
        <FIELD NAME="timecreated" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="timemodified" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="schoolid" TYPE="foreign" FIELDS="schoolid" REFTABLE="gradereport_transcript_schools" REFFIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="school_sort" UNIQUE="false" FIELDS="schoolid, sortorder"/>
      </INDEXES>
    </TABLE>

    <!-- Symbols and notations table -->
    <TABLE NAME="gradereport_transcript_symbols" COMMENT="Stores custom symbols/notations per school">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="schoolid" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Reference to school"/>
        <FIELD NAME="symbol" TYPE="char" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="Symbol notation (W, I, T, etc.)"/>
        <FIELD NAME="meaning" TYPE="text" NOTNULL="true" SEQUENCE="false" COMMENT="Full meaning/description"/>
        <FIELD NAME="sortorder" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Display order"/>
        <FIELD NAME="timecreated" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="timemodified" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="schoolid" TYPE="foreign" FIELDS="schoolid" REFTABLE="gradereport_transcript_schools" REFFIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="school_sort" UNIQUE="false" FIELDS="schoolid, sortorder"/>
      </INDEXES>
    </TABLE>
  </TABLES>
</XMLDB>
